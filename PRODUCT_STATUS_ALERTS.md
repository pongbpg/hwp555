# ฟิลด์การจัดการสินค้าและการแจ้งเตือน

## ฟิลด์ใหม่ที่เพิ่มเข้า

### 1. สถานะสินค้า (Product Status)
**ตำแหน่ง**: ในหน้าแก้ไข/เพิ่มสินค้า > ส่วน "สถานะสินค้า"

**ค่าที่เป็นไปได้**:
- `✅ ใช้งาน` (active) - สินค้าแสดงในช่องสั่งซื้อ
- `📦 หยุดใช้งาน` (archived) - สินค้าไม่แสดงในช่องสั่งซื้อ

**วัตถุประสงค์**:
- ใช้สำหรับสินค้าที่ไม่ได้ขายแล้ว แต่ยังต้องเก็บข้อมูลเดิม
- ไม่ต้องลบสินค้า เพียงแค่ปิดการใช้งาน
- สินค้า archived ยังคงแสดงในรายการประวัติ แต่ไม่ปรากฏในรายการที่ใช้งาน

**ใช้งาน**:
1. เปิดหน้า Products
2. คลิก "แก้ไข" สินค้าที่ต้องการหยุดใช้งาน
3. ในส่วน "สถานะสินค้า" เลือก "📦 หยุดใช้งาน"
4. คลิก "✅ อัพเดทสินค้า"

---

### 2. เปิดปิดการแจ้งเตือนสต็อกต่ำ (Enable Stock Alerts)
**ตำแหน่ง**: ในหน้าแก้ไข/เพิ่มสินค้า > ส่วน "เปิดการแจ้งเตือนสต็อกต่ำ"

**ค่าที่เป็นไปได้**:
- ✅ **เปิด** (checked) - ระบบจะแจ้งเตือนเมื่อสต็อกต่ำ
- ❌ **ปิด** (unchecked) - ระบบจะไม่แจ้งเตือนเมื่อสต็อกต่ำ

**วัตถุประสงค์**:
- ใช้สำหรับสินค้าที่ไม่ต้องการสั่งซื้ออีกเลย (ถูก discontinued)
- ไม่ต้องลบสินค้า แต่ได้การทำงานที่สะดวก
- จะไม่ได้รับการแจ้งเตือนจาก:
  - หน้า Alerts (🔔 การแจ้งเตือน)
  - LINE Notifications
  - Insights API (reorder suggestions)

**ใช้งาน**:
1. เปิดหน้า Products
2. คลิก "แก้ไข" สินค้าที่ต้องการปิดแจ้งเตือน
3. ในส่วน "🔔 เปิดการแจ้งเตือนสต็อกต่ำ" ยกเลิกการเลือก
4. คลิก "✅ อัพเดทสินค้า"

---

## ตัวอย่างการใช้งาน

### สถานการณ์ 1: สินค้า Discontinued
สินค้าเสื้อยืด "รุ่นเก่า" ที่จะหยุดผลิต:
1. ตั้งค่า **สถานะสินค้า** = "📦 หยุดใช้งาน"
2. ตั้งค่า **เปิดการแจ้งเตือน** = ❌ ปิด

ผลลัพธ์:
- ไม่สามารถสั่งซื้อรุ่นนี้ได้อีก
- ไม่มีการแจ้งเตือนสต็อกต่ำ
- ข้อมูลเดิมยังคงเก็บไว้

### สถานการณ์ 2: สินค้าใช้งานได้แต่ปิดแจ้งเตือน
สินค้าที่คุณยังคงขายแต่ไม่จำเป็นต้องเก็บสต็อกเยอะ (เช่น สินค้า custom order):
1. ตั้งค่า **สถานะสินค้า** = "✅ ใช้งาน"
2. ตั้งค่า **เปิดการแจ้งเตือน** = ❌ ปิด

ผลลัพธ์:
- ยังคงสามารถสั่งซื้อได้
- ไม่มีการแจ้งเตือนสต็อกต่ำ
- สะดวกสำหรับสินค้า custom order หรือ made-to-order

---

## ตำแหน่งของฟิลด์ใน UI

### หน้า Products (รายการสินค้า)
- **Status Column**: แสดงสถานะ "✅ ใช้งาน" หรือ "📦 หยุดใช้"
- **Details Section**: แสดง "🔇 ปิดแจ้งเตือน" ถ้าปิดการแจ้งเตือน

### หน้าแก้ไขสินค้า
- **Row 2** มีฟิลด์ 2 ช่องสำหรับตั้งค่า:
  - สถานะสินค้า (dropdown)
  - เปิดการแจ้งเตือนสต็อกต่ำ (checkbox)

---

## ผลกระทบต่อระบบการแจ้งเตือน

### Alerts API (`/inventory/alerts`)
- ✅ **ยังคงรับการแจ้งเตือนจากสินค้า archived** ที่เปิดแจ้งเตือน
- ❌ **ไม่รับการแจ้งเตือนจากสินค้าที่ปิดแจ้งเตือน** (enableStockAlerts=false)

### LINE Notifications
- ❌ **ไม่ส่งแจ้งเตือนจาก** `checkAndAlertAfterSale()` สำหรับสินค้าที่ปิดแจ้งเตือน

### Insights API (`/inventory/insights`)
- ℹ️ **ยังแสดง insights** สำหรับสินค้า archived ที่เปิดแจ้งเตือน
- ❌ **ไม่รวม reorder suggestions** สำหรับสินค้าที่ปิดแจ้งเตือน

---

## ความแตกต่างระหว่าง "หยุดใช้งาน" และ "ปิดแจ้งเตือน"

| ลักษณะ | หยุดใช้งาน (archived) | ปิดแจ้งเตือน (enableStockAlerts=false) |
|--------|-----|-----|
| **แสดงในช่องสั่งซื้อ** | ❌ ไม่แสดง | ✅ แสดง |
| **สามารถสั่งซื้อ** | ❌ ไม่ได้ | ✅ ได้ |
| **แจ้งเตือนสต็อกต่ำ** | ❌ ไม่แจ้ง | ❌ ไม่แจ้ง |
| **ใช้กับสินค้า** | Discontinued | Custom/Made-to-order |

---

## ปัญหาที่แก้ไข

### ปัญหาเดิม
- สินค้าที่ไม่ขายแล้วยังแสดงในช่องสั่งซื้อ ทำให้ confused
- ต้องการปิดแจ้งเตือนสินค้าบางตัวแต่ยังต้องใช้งาน

### วิธีแก้ไข
- ✅ ฟิลด์ **status** เพื่อควบคุมการแสดงผลในช่องสั่งซื้อ
- ✅ ฟิลด์ **enableStockAlerts** เพื่อควบคุมการแจ้งเตือน

---

## ข้อมูลเพิ่มเติม

### Database
- **Field**: `status` (enum: 'active', 'archived')
- **Field**: `enableStockAlerts` (boolean, default: true)

### API Endpoints ที่เปลี่ยนแปลง
- `POST /products` - รับค่า status และ enableStockAlerts
- `PUT /products/:id` - อัพเดทค่า status และ enableStockAlerts
- `GET /inventory/alerts` - ตัวกรองสินค้า enableStockAlerts=true
